{"version":3,"sources":["../management.js"],"names":["akeeba_passwordless_create_credentials","store_id","interface_selector","navigator","alert","Joomla","JText","_","console","log","elStore","document","getElementById","publicKey","JSON","parse","atob","dataset","public_key","post_url","postback_url","arrayToBase64String","a","btoa","String","fromCharCode","fixedChallenge","challenge","replace","Uint8Array","from","window","c","charCodeAt","user","id","excludeCredentials","map","data","credentials","create","then","publicKeyCredential","type","rawId","response","clientDataJSON","attestationObject","postBackData","stringify","jQuery","post","done","responseHTML","elements","querySelectorAll","elContainer","outerHTML","fail","akeeba_passwordless_handle_creation_error","status","statusText","error","message","akeeba_passwordless_edit_label","that","elTR","parentElement","credentialId","credential_id","elTDs","elLabelTD","elButtonsTD","elButtons","elEdit","elDelete","oldLabel","innerText","elInput","createElement","name","defaultValue","elSave","className","addEventListener","e","elNewLabel","value","result","disabled","elCancel","innerHTML","appendChild","akeeba_passwordless_delete","removeChild"],"mappings":"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","sourcesContent":["/**\n * @package   AkeebaPasswordlessLogin\n * @copyright Copyright (c)2018-2019 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   GNU General Public License version 3, or later\n */\n\n/**\n * Ask the user to link an authenticator using the provided public key (created server-side). Posts the credentials to\n * the URL defined in post_url using AJAX. That URL must re-render the management interface. These contents will replace\n * the element identified by the interface_selector CSS selector.\n *\n * @param   {String}  store_id            CSS ID for the element storing the configuration in its data properties\n * @param   {String}  interface_selector  CSS selector for the GUI container\n */\nfunction akeeba_passwordless_create_credentials(store_id, interface_selector)\n{\n    // Make sure the browser supports Webauthn\n    if (!('credentials' in navigator)) {\n        alert(Joomla.JText._('PLG_SYSTEM_WEBAUTHN_ERR_NO_BROWSER_SUPPORT'))\n\n        console.log(\"This browser does not support Webauthn\");\n        return;\n    }\n\n    // Extract the configuration from the store\n    let elStore = document.getElementById(store_id);\n\n    if (!elStore)\n    {\n        return;\n    }\n\n    let publicKey = JSON.parse(atob(elStore.dataset.public_key));\n    let post_url  = atob(elStore.dataset.postback_url);\n\n    // Utility function to convert array data to base64 strings\n    function arrayToBase64String(a)\n    {\n        return btoa(String.fromCharCode(...a));\n    }\n\n    // Convert the public key information to a format usable by the browser's credentials managemer\n    var fixedChallenge = publicKey.challenge.replace(/-/g, '+').replace(/_/g, '/');\n    publicKey.challenge = Uint8Array.from(window.atob(fixedChallenge), c => c.charCodeAt(0));\n    publicKey.user.id   = Uint8Array.from(window.atob(publicKey.user.id), c => c.charCodeAt(0));\n\n    if (publicKey.excludeCredentials)\n    {\n        publicKey.excludeCredentials = publicKey.excludeCredentials.map(function (data) {\n            return {\n                ...data,\n                \"id\": Uint8Array.from(window.atob(data.id), c => c.charCodeAt(0))\n            };\n        });\n    }\n\n    // Ask the browser to prompt the user for their authenticator\n    navigator.credentials.create({publicKey})\n        .then(function (data) {\n            let publicKeyCredential = {\n                id:       data.id,\n                type:     data.type,\n                rawId:    arrayToBase64String(new Uint8Array(data.rawId)),\n                response: {\n                    clientDataJSON:    arrayToBase64String(new Uint8Array(data.response.clientDataJSON)),\n                    attestationObject: arrayToBase64String(new Uint8Array(data.response.attestationObject))\n                }\n            };\n\n            let postBackData = {\n                \"option\":   \"com_ajax\",\n                \"group\":    \"system\",\n                \"plugin\":   \"webauthn\",\n                \"format\":   \"raw\",\n                \"akaction\": \"create\",\n                \"encoding\": \"raw\",\n                \"data\":     btoa(JSON.stringify(publicKeyCredential))\n            };\n\n            window.jQuery.post(post_url, postBackData)\n                .done(function (responseHTML) {\n                    let elements = document.querySelectorAll(interface_selector);\n\n                    if (!elements)\n                    {\n                        return;\n                    }\n\n                    let elContainer = elements[0];\n\n                    elContainer.outerHTML = responseHTML;\n                })\n                .fail(function (data) {\n                    akeeba_passwordless_handle_creation_error(data.status + ' ' + data.statusText);\n                });\n\n\n        }, function (error) {\n            // An error occurred: timeout, request to provide the authenticator refused, hardware / software error...\n            akeeba_passwordless_handle_creation_error(error);\n        });\n}\n\n/**\n * A simple error handler\n *\n * @param   {String}  message\n */\nfunction akeeba_passwordless_handle_creation_error(message)\n{\n    alert(message);\n\n    console.log(message);\n}\n\n/**\n * Edit label button\n *\n * @param   {Element} that      The button being clicked\n * @param   {String}  store_id  CSS ID for the element storing the configuration in its data properties\n */\nfunction akeeba_passwordless_edit_label(that, store_id)\n{\n    // Extract the configuration from the store\n    let elStore = document.getElementById(store_id);\n\n    if (!elStore)\n    {\n        return;\n    }\n\n    let post_url = atob(elStore.dataset.postback_url);\n\n    // Find the UI elements\n    let elTR         = that.parentElement.parentElement;\n    let credentialId = elTR.dataset.credential_id;\n    let elTDs        = elTR.querySelectorAll(\"td\");\n    let elLabelTD    = elTDs[0];\n    let elButtonsTD  = elTDs[1];\n    let elButtons    = elButtonsTD.querySelectorAll(\"button\");\n    let elEdit       = elButtons[0];\n    let elDelete     = elButtons[1];\n\n    // Show the editor\n    let oldLabel = elLabelTD.innerText;\n\n    let elInput          = document.createElement(\"input\");\n    elInput.type         = \"text\";\n    elInput.name         = \"label\";\n    elInput.defaultValue = oldLabel;\n\n    let elSave       = document.createElement(\"button\");\n    elSave.className = \"akpwl-btn--green--small\";\n    elSave.innerText = Joomla.JText._(\"PLG_SYSTEM_WEBAUTHN_MANAGE_BTN_SAVE_LABEL\");\n    elSave.addEventListener(\"click\", function (e) {\n        let elNewLabel = elInput.value;\n\n        if (elNewLabel !== '')\n        {\n            let postBackData = {\n                \"option\": \"com_ajax\",\n                \"group\": \"system\",\n                \"plugin\": \"webauthn\",\n                \"format\": \"json\",\n                \"encoding\": \"json\",\n                \"akaction\": \"savelabel\",\n                \"credential_id\": credentialId,\n                \"new_label\": elNewLabel\n            };\n\n            window.jQuery.post(post_url, postBackData)\n                .done(function (result) {\n                    if ((result !== true) && (result !== \"true\"))\n                    {\n                        akeeba_passwordless_handle_creation_error(Joomla.JText._('PLG_SYSTEM_WEBAUTHN_ERR_LABEL_NOT_SAVED'));\n\n                        return;\n                    }\n\n                    //alert(Joomla.JText._('PLG_SYSTEM_WEBAUTHN_MSG_SAVED_LABEL'));\n                })\n                .fail(function (data) {\n                    akeeba_passwordless_handle_creation_error(Joomla.JText._('PLG_SYSTEM_WEBAUTHN_ERR_LABEL_NOT_SAVED') + ' -- ' + data.status + ' ' + data.statusText);\n                });\n        }\n\n        elLabelTD.innerText = elNewLabel;\n        elEdit.disabled     = false;\n        elDelete.disabled   = false;\n\n        return false;\n    }, false);\n\n    let elCancel       = document.createElement(\"button\");\n    elCancel.className = \"akpwl-btn--red--small\";\n    elCancel.innerText = Joomla.JText._(\"PLG_SYSTEM_WEBAUTHN_MANAGE_BTN_CANCEL_LABEL\");\n    elCancel.addEventListener(\"click\", function (e) {\n        elLabelTD.innerText = oldLabel;\n        elEdit.disabled     = false;\n        elDelete.disabled   = false;\n\n        return false;\n    }, false);\n\n    elLabelTD.innerHTML = \"\";\n    elLabelTD.appendChild(elInput);\n    elLabelTD.appendChild(elSave);\n    elLabelTD.appendChild(elCancel);\n    elEdit.disabled   = true;\n    elDelete.disabled = true;\n\n    return false;\n}\n\n/**\n * Delete button\n *\n * @param   {Element} that      The button being clicked\n * @param   {String}  store_id  CSS ID for the element storing the configuration in its data properties\n */\nfunction akeeba_passwordless_delete(that, store_id)\n{\n    // Extract the configuration from the store\n    let elStore = document.getElementById(store_id);\n\n    if (!elStore)\n    {\n        return;\n    }\n\n    let post_url = atob(elStore.dataset.postback_url);\n\n    // Find the UI elements\n    let elTR         = that.parentElement.parentElement;\n    let credentialId = elTR.dataset.credential_id;\n    let elTDs        = elTR.querySelectorAll(\"td\");\n    let elButtonsTD  = elTDs[1];\n    let elButtons    = elButtonsTD.querySelectorAll(\"button\");\n    let elEdit       = elButtons[0];\n    let elDelete     = elButtons[1];\n\n    elEdit.disabled     = true;\n    elDelete.disabled   = true;\n\n    // Delete the record\n    let postBackData = {\n        \"option\": \"com_ajax\",\n        \"group\": \"system\",\n        \"plugin\": \"webauthn\",\n        \"format\": \"json\",\n        \"encoding\": \"json\",\n        \"akaction\": \"delete\",\n        \"credential_id\": credentialId,\n    };\n\n    window.jQuery.post(post_url, postBackData)\n        .done(function (result) {\n            if ((result !== true) && (result !== \"true\"))\n            {\n                elEdit.disabled     = false;\n                elDelete.disabled   = false;\n\n                akeeba_passwordless_handle_creation_error(Joomla.JText._(\"PLG_SYSTEM_WEBAUTHN_ERR_NOT_DELETED\"));\n\n                return;\n            }\n\n            elTR.parentElement.removeChild(elTR);\n\n            //alert(Joomla.JText._(\"PLG_SYSTEM_WEBAUTHN_MSG_DELETED\"));\n        })\n        .fail(function (data) {\n            elEdit.disabled     = false;\n            elDelete.disabled   = false;\n\n            akeeba_passwordless_handle_creation_error(Joomla.JText._(\"PLG_SYSTEM_WEBAUTHN_ERR_NOT_DELETED\") + \" -- \" + data.status + \" \" + data.statusText);\n        });\n\n    return false;\n}"],"file":"management.js"}